t10.plot = lang.by.year %>%
filter(!str_detect(language, 'N/A')) %>%
group_by(year) %>%
mutate(rankinyear = rank(desc(popcount))) %>%
filter(language %in% unique(top10.by.year$language)) %>%
# top10.by.year %>%
ggplot(aes(x = year, y = rankinyear, group = language)) +
geom_point(aes(size = popcount), color = 'grey') +
geom_line(color = 'grey') +
geom_point(
data = . %>% filter(rankinyear > 4),
aes(color = language, size = popcount)
) +
geom_line(
data = . %>% filter(rankinyear > 4),
aes(color = language)
) +
# names at end
geom_text(
data = . %>% group_by(language) %>% filter(year == max(year)),
aes(year + 0.6, rankinyear, label = language),
hjust = 'left',
size = 3.5
) +
scale_x_continuous(
limits = c(1980, 2021),
breaks = c(1980, 1990, 2000, 2010, 2018),
) +
# # names at beginning
# geom_text(
#   data = . %>% group_by(language) %>% filter(year == min(year)),
#   aes(year - 0.7, rankinyear, label = language),
#   hjust = 'right',
#   size = 3.5
# ) +
# scale_x_continuous(
#   limits = c(1978, 2018),
#   breaks = c(1980, 1990, 2000, 2010, 2018),
# ) +
scale_colour_brewer(palette = 'Paired') +
scale_y_reverse(
breaks = 1:10,
limits = c(10, 1)
) +
theme_minimal() +
theme(legend.position = 'none') +
ylab('Rank in year') +
xlab('') +
ggtitle('Top 10 languages spoken in L.A. County')
t10.plot
t10.plot = lang.by.year %>%
filter(!str_detect(language, 'N/A')) %>%
group_by(year) %>%
mutate(rankinyear = rank(desc(popcount))) %>%
filter(language %in% unique(top10.by.year$language)) %>%
# top10.by.year %>%
ggplot(aes(x = year, y = rankinyear, group = language)) +
geom_point(aes(size = popcount), color = 'grey') +
geom_line(color = 'grey') +
geom_point(
data = . %>% filter(rankinyear > 4),
aes(color = language, size = popcount)
) +
geom_line(
data = . %>% filter(rankinyear > 4),
aes(color = language)
) +
# names at end
geom_text(
data = . %>% group_by(language) %>% filter(year == max(year)),
aes(year + 0.6, rankinyear, label = language),
hjust = 'left',
size = 3.5
) +
scale_x_continuous(
limits = c(1980, 2021),
breaks = c(1980, 1990, 2000, 2010, 2018),
) +
# # names at beginning
# geom_text(
#   data = . %>% group_by(language) %>% filter(year == min(year)),
#   aes(year - 0.7, rankinyear, label = language),
#   hjust = 'right',
#   size = 3.5
# ) +
# scale_x_continuous(
#   limits = c(1978, 2018),
#   breaks = c(1980, 1990, 2000, 2010, 2018),
# ) +
scale_colour_brewer(palette = 'Paired') +
scale_y_continuous(
breaks = 10:1,
limits = c(10, 1)
) +
theme_minimal() +
theme(legend.position = 'none') +
ylab('Rank in year') +
xlab('') +
ggtitle('Top 10 languages spoken in L.A. County')
t10.plot
t10.plot = lang.by.year %>%
filter(!str_detect(language, 'N/A')) %>%
group_by(year) %>%
mutate(rankinyear = rank(desc(popcount))) %>%
filter(language %in% unique(top10.by.year$language)) %>%
# top10.by.year %>%
ggplot(aes(x = year, y = rankinyear, group = language)) +
geom_point(aes(size = popcount), color = 'grey') +
geom_line(color = 'grey') +
geom_point(
data = . %>% filter(rankinyear > 4),
aes(color = language, size = popcount)
) +
geom_line(
data = . %>% filter(rankinyear > 4),
aes(color = language)
) +
# names at end
geom_text(
data = . %>% group_by(language) %>% filter(year == max(year)),
aes(year + 0.6, rankinyear, label = language),
hjust = 'left',
size = 3.5
) +
scale_x_continuous(
limits = c(1980, 2021),
breaks = c(1980, 1990, 2000, 2010, 2018),
) +
# # names at beginning
# geom_text(
#   data = . %>% group_by(language) %>% filter(year == min(year)),
#   aes(year - 0.7, rankinyear, label = language),
#   hjust = 'right',
#   size = 3.5
# ) +
# scale_x_continuous(
#   limits = c(1978, 2018),
#   breaks = c(1980, 1990, 2000, 2010, 2018),
# ) +
scale_colour_brewer(palette = 'Paired') +
scale_y_reverse(
breaks = 1:10
) +
theme_minimal() +
theme(legend.position = 'none') +
ylab('Rank in year') +
xlab('') +
ggtitle('Top 10 languages spoken in L.A. County')
t10.plot
?scale_y_reverse
t10.plot
t10.plot = lang.by.year %>%
filter(!str_detect(language, 'N/A')) %>%
group_by(year) %>%
mutate(rankinyear = rank(desc(popcount))) %>%
filter(language %in% unique(top10.by.year$language)) %>%
# top10.by.year %>%
ggplot(aes(x = year, y = rankinyear, group = language)) +
geom_point(aes(size = popcount), color = 'grey') +
geom_line(color = 'grey') +
geom_point(
data = . %>% filter(rankinyear > 4),
aes(color = language, size = popcount)
) +
geom_line(
data = . %>% filter(rankinyear > 4),
aes(color = language)
) +
# names at end
geom_text(
data = . %>% group_by(language) %>% filter(year == max(year)),
aes(year + 0.6, rankinyear, label = language),
hjust = 'left',
size = 3.5
) +
scale_x_continuous(
limits = c(1980, 2021),
breaks = c(1980, 1990, 2000, 2010, 2018),
) +
# # names at beginning
# geom_text(
#   data = . %>% group_by(language) %>% filter(year == min(year)),
#   aes(year - 0.7, rankinyear, label = language),
#   hjust = 'right',
#   size = 3.5
# ) +
# scale_x_continuous(
#   limits = c(1978, 2018),
#   breaks = c(1980, 1990, 2000, 2010, 2018),
# ) +
scale_colour_brewer(palette = 'Paired') +
scale_y_reverse(
# breaks = 1:10
) +
theme_minimal() +
theme(legend.position = 'none') +
ylab('Rank in year') +
xlab('') +
ggtitle('Top 10 languages spoken in L.A. County')
t10.plot
t10.plot = lang.by.year %>%
filter(!str_detect(language, 'N/A')) %>%
group_by(year) %>%
mutate(rankinyear = rank(desc(popcount))) %>%
filter(language %in% unique(top10.by.year$language)) %>%
# top10.by.year %>%
ggplot(aes(x = year, y = rankinyear, group = language)) +
geom_point(aes(size = popcount), color = 'grey') +
geom_line(color = 'grey') +
geom_point(
data = . %>% filter(rankinyear > 4),
aes(color = language, size = popcount)
) +
geom_line(
data = . %>% filter(rankinyear > 4),
aes(color = language)
) +
# names at end
geom_text(
data = . %>% group_by(language) %>% filter(year == max(year)),
aes(year + 0.6, rankinyear, label = language),
hjust = 'left',
size = 3.5
) +
scale_x_continuous(
limits = c(1980, 2021),
breaks = c(1980, 1990, 2000, 2010, 2018),
) +
# # names at beginning
# geom_text(
#   data = . %>% group_by(language) %>% filter(year == min(year)),
#   aes(year - 0.7, rankinyear, label = language),
#   hjust = 'right',
#   size = 3.5
# ) +
# scale_x_continuous(
#   limits = c(1978, 2018),
#   breaks = c(1980, 1990, 2000, 2010, 2018),
# ) +
scale_colour_brewer(palette = 'Paired') +
scale_y_reverse(
# breaks = 1:10
limits = c(1, 10)
) +
theme_minimal() +
theme(legend.position = 'none') +
ylab('Rank in year') +
xlab('') +
ggtitle('Top 10 languages spoken in L.A. County')
t10.plot
t10.plot = lang.by.year %>%
filter(!str_detect(language, 'N/A')) %>%
group_by(year) %>%
mutate(rankinyear = rank(desc(popcount))) %>%
filter(language %in% unique(top10.by.year$language)) %>%
# top10.by.year %>%
ggplot(aes(x = year, y = rankinyear, group = language)) +
geom_point(aes(size = popcount), color = 'grey') +
geom_line(color = 'grey') +
geom_point(
data = . %>% filter(rankinyear > 4),
aes(color = language, size = popcount)
) +
geom_line(
data = . %>% filter(rankinyear > 4),
aes(color = language)
) +
# names at end
geom_text(
data = . %>% group_by(language) %>% filter(year == max(year)),
aes(year + 0.6, rankinyear, label = language),
hjust = 'left',
size = 3.5
) +
scale_x_continuous(
limits = c(1980, 2021),
breaks = c(1980, 1990, 2000, 2010, 2018),
) +
# # names at beginning
# geom_text(
#   data = . %>% group_by(language) %>% filter(year == min(year)),
#   aes(year - 0.7, rankinyear, label = language),
#   hjust = 'right',
#   size = 3.5
# ) +
# scale_x_continuous(
#   limits = c(1978, 2018),
#   breaks = c(1980, 1990, 2000, 2010, 2018),
# ) +
scale_colour_brewer(palette = 'Paired') +
scale_y_reverse(
# breaks = 1:10
limits = c(10, 1)
) +
theme_minimal() +
theme(legend.position = 'none') +
ylab('Rank in year') +
xlab('') +
ggtitle('Top 10 languages spoken in L.A. County')
t10.plot
t10.plot = lang.by.year %>%
filter(!str_detect(language, 'N/A')) %>%
group_by(year) %>%
mutate(rankinyear = rank(desc(popcount))) %>%
filter(language %in% unique(top10.by.year$language)) %>%
# top10.by.year %>%
ggplot(aes(x = year, y = rankinyear, group = language)) +
geom_point(aes(size = popcount), color = 'grey') +
geom_line(color = 'grey') +
geom_point(
data = . %>% filter(rankinyear > 4),
aes(color = language, size = popcount)
) +
geom_line(
data = . %>% filter(rankinyear > 4),
aes(color = language)
) +
# names at end
geom_text(
data = . %>% group_by(language) %>% filter(year == max(year)),
aes(year + 0.6, rankinyear, label = language),
hjust = 'left',
size = 3.5
) +
scale_x_continuous(
limits = c(1980, 2021),
breaks = c(1980, 1990, 2000, 2010, 2018),
) +
# # names at beginning
# geom_text(
#   data = . %>% group_by(language) %>% filter(year == min(year)),
#   aes(year - 0.7, rankinyear, label = language),
#   hjust = 'right',
#   size = 3.5
# ) +
# scale_x_continuous(
#   limits = c(1978, 2018),
#   breaks = c(1980, 1990, 2000, 2010, 2018),
# ) +
scale_colour_brewer(palette = 'Paired') +
scale_y_reverse(
# breaks = 1:10
limits = c(10, 1),
breaks = 10:1
) +
theme_minimal() +
theme(legend.position = 'none') +
ylab('Rank in year') +
xlab('') +
ggtitle('Top 10 languages spoken in L.A. County')
t10.plot
t10.plot = top10.by.year %>%
ggplot(aes(x = year, y = rankinyear, group = language)) +
geom_point(aes(size = popcount), color = 'grey') +
geom_line(color = 'grey') +
geom_point(
data = . %>% filter(rankinyear > 4),
aes(color = language, size = popcount)
) +
geom_line(
data = . %>% filter(rankinyear > 4),
aes(color = language)
) +
# names at end
geom_text(
data = . %>% group_by(language) %>% filter(year == max(year)),
aes(year + 0.6, rankinyear, label = language),
hjust = 'left',
size = 3.5
) +
scale_x_continuous(
limits = c(1980, 2021),
breaks = c(1980, 1990, 2000, 2010, 2018),
) +
# # names at beginning
# geom_text(
#   data = . %>% group_by(language) %>% filter(year == min(year)),
#   aes(year - 0.7, rankinyear, label = language),
#   hjust = 'right',
#   size = 3.5
# ) +
# scale_x_continuous(
#   limits = c(1978, 2018),
#   breaks = c(1980, 1990, 2000, 2010, 2018),
# ) +
scale_colour_brewer(palette = 'Paired') +
scale_y_reverse(
breaks = 1:10
) +
theme_minimal() +
theme(legend.position = 'none') +
ylab('Rank in year') +
xlab('') +
ggtitle('Top 10 languages spoken in L.A. County')
t10.plot
t10.plot = top10.by.year %>%
ggplot(aes(x = year, y = rankinyear, group = language)) +
geom_point(aes(size = popcount), color = 'grey') +
geom_line(color = 'grey') +
geom_point(
data = . %>% filter(rankinyear > 4),
aes(color = language, size = popcount)
) +
geom_line(
data = . %>% filter(rankinyear > 4),
aes(color = language)
) +
# # names at end
# geom_text(
#   data = . %>% group_by(language) %>% filter(year == max(year)),
#   aes(year + 0.6, rankinyear, label = language),
#   hjust = 'left',
#   size = 3.5
# ) +
# scale_x_continuous(
#   limits = c(1980, 2021),
#   breaks = c(1980, 1990, 2000, 2010, 2018),
# ) +
# names at beginning
geom_text(
data = . %>% group_by(language) %>% filter(year == min(year)),
aes(year - 0.7, rankinyear, label = language),
hjust = 'right',
size = 3.5
) +
scale_x_continuous(
limits = c(1978, 2018),
breaks = c(1980, 1990, 2000, 2010, 2018),
) +
scale_colour_brewer(palette = 'Paired') +
scale_y_reverse(
breaks = 1:10
) +
theme_minimal() +
theme(legend.position = 'none') +
ylab('Rank in year') +
xlab('') +
ggtitle('Top 10 languages spoken in L.A. County')
t10.plot
t10.plot = top10.by.year %>%
ggplot(aes(x = year, y = rankinyear, group = language)) +
geom_point(aes(size = popcount), color = 'grey') +
geom_line(color = 'grey') +
geom_point(
data = . %>% filter(rankinyear > 4),
aes(color = language, size = popcount)
) +
geom_line(
data = . %>% filter(rankinyear > 4),
aes(color = language)
) +
# names at end
geom_text(
data = . %>% group_by(language) %>% filter(year == max(year)),
aes(year + 0.6, rankinyear, label = language),
hjust = 'left',
size = 3.5
) +
scale_x_continuous(
limits = c(1980, 2021),
breaks = c(1980, 1990, 2000, 2010, 2018),
) +
# # names at beginning
# geom_text(
#   data = . %>% group_by(language) %>% filter(year == min(year)),
#   aes(year - 0.7, rankinyear, label = language),
#   hjust = 'right',
#   size = 3.5
# ) +
# scale_x_continuous(
#   limits = c(1978, 2018),
#   breaks = c(1980, 1990, 2000, 2010, 2018),
# ) +
scale_colour_brewer(palette = 'Paired') +
scale_y_reverse(
breaks = 1:10
) +
theme_minimal() +
theme(legend.position = 'none') +
ylab('Rank in year') +
xlab('') +
ggtitle('Top 10 languages spoken in L.A. County')
t10.plot
ggsave('top-10.pdf', device = 'pdf', width = 10, height = 8, units = 'in')
t10.lang = top10.by.year %>%
select(year, rankinyear, language) %>%
pivot_wider(names_from = year, values_from = language)
t10.pct = top10.by.year %>%
select(year, pop.pct, rankinyear) %>%
pivot_wider(names_from = year, values_from = pop.pct)
t10.counts = top10.by.year %>%
select(year, popcount, rankinyear) %>%
pivot_wider(names_from = year, values_from = popcount)
t10.lang
t10.pct
t10.counts
t10.master = t10.lang %>%
left_join(
t10.counts,
by = 'rankinyear',
suffix = c('_lang', '_count')
) %>%
left_join(
t10.pct %>%
rename_at(vars(-rankinyear), ~str_c(., '_pct')),
by = 'rankinyear',
) %>%
select(rankinyear, starts_with('1980'), starts_with('1990'), starts_with('2000'), starts_with('2010'), starts_with('2018'))
t10.master
t10.master %>% write_csv('top-10-la-county-by-year.csv')
top10.by.year %>% write_csv('top-10-la-county-by-year-long.csv')
top10.by.year %>% distinct(language)
